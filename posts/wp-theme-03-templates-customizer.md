---
title: "WP Theme - 03 Theme Template & The Customizer"
date: "2021-05-24"
---

# 03 Templates & The Customizer

## Theme Hierachy & Single Post Template

Posts

- single-{post-type}-{slug}.php (single-post-hello.php)
- single-{post-type}.php (single-post.php)
- single.php: single.php(post template) / page.php(page template)
- singular.php: an extra fallback for all post types, regardless if built-in or custom
- index.php

Navigation

- `previous_posts_link()`, `next_posts_link()`: paginating pages with multiple posts
- `previous_post_link()`, `next_post_link()`: providing links to the next and previous post for a single post

single.php

```php
<?php
if (have_posts()){
  while(have_posts()){
    the_post();
    global $post;
    $author_ID    = $post->post_author;
    $author_URL   = get_author_posts_url($author_ID);
?>

  <?php the_title(); ?>
  <?php echo get_the_date(); ?>
  <?php the_author(); ?>
  <?php the_category(); ?>
  <?php comments_number(); ?>
  <?php
    if (has_post_thumbnail()){
      <?php the_permalink(); ?>
      <?php the_post_thumbnail('full'); ?>
    }
  ?>
  <?php
    the_content();
    $default = array(
      'before'    => '<p class="text-center">' . __('Page: ', 'udemy'),
      'after'     => '</p>'
    );
  ?>
  <?php the_tags('', ' '); ?>
  <?php previous_post_link(); ?>
  <?php next_post_link(); ?>

<?php
  }
}
?>
```

[Theme Development](https://codex.wordpress.org/Theme_Development)

[VISUALIZE THE WORDPRESS TEMPLATE HIERARCHY](https://wphierarchy.com/)

[Template Hierarchy](https://developer.wordpress.org/themes/basics/template-hierarchy/)

## Comments Template

- pluggable: the code can be extended by 3rd party plugins or WordPress itself.
- comments.php: a template for comments
- `post_password_required()`: check if the current post is password protected
- `comment_form()`
  - display form
  - perform additional checks before displaying the form
- `comments`:
  - global varialble
  - available for access inside a loop

single.php

```php
<?php if (comments_open() || get_comments_number()) {
  comments_template();
}
?>
```

comments.php

```php
<?php
if (post_password_required()) {
  return;
  // function 으로 해당 템플릿을 불러오기 때문에 이후 코드는 실행 되지 않는다.
};
?>

// 만약 comment가 있다면
<?php if (have_comments()) { ?>
  // total count
  <?php comments_number(); ?>
    // comments iteration
    <?php foreach ($comments as $comment) { ?>
        // avater: binding, size, , , attrs
        <?php echo get_avatar($comment, 60, '', '', ['class', 'avatar-60 photo avatar-default']); ?>
        // 작성자
        <?php comment_author(); ?>
        // 작성 날짜
        <?php comment_date(); ?>
        // 작성 내용
        <?php comment_text() ?>
      <?php } ?>
    <?php } ?>
    // pagination
    the_comments_pagination();
<?php } ?>

<?php
  comment_form([
    'comment_filed' => '',
    'fields'        => [
      'author'      => '<div><label>' . __('Name', 'udemy').'<label><input type="text" name="author" class=""/></div>',
      'email'       => '<div><label>' . __('Email', 'udemy').'<label><input type="text" name="email" class=""/></div>',
      'url'         => '<div><label>' . __('Website', 'udemy').'<label><input type="text" name="url" class=""/></div>',
    ],
    'class_submit'  => '',
    'label_submit'  => __('Submit Comment', 'udemy'),
    'title_reply'   => __('Leave a Comment', 'udemy')
  ])
?>
```

## Author Template Tags

- `nl2br()`: format text / long user bio's readable
- `get avartar()`: accepts a user ID, email or comment object

(`get_avatar( mixed $id_or_email, int $size = 96, string $default = '', string $alt = '', array $args = null )`)[https://developer.wordpress.org/reference/functions/get_avatar/]

(`the_author_meta( string $field = '', int|false $user_id = false )`)[https://developer.wordpress.org/reference/functions/the_author_meta/]

single.php

```php
// auther url & name
<strong>
  Posted by
  <a href="<?php echo $author_URL; ?>">
    <?php the_author(); ?>
  </a>
</strong>

// author avatar
<div class="author-image">
  <?php echo get_avatar($author_ID, 90, '', false, ['class' => 'img-circle']); ?>
</div>

// get method:
// nl2br: 줄 바꿈 하기 전에 br를 삽입한다.
<?php echo nl2br(get_the_author_meta('description')); ?>
```

## Related Posts using the WP_Query Class

- WP_Query class: query to the database for the posts. (create & executed)
- Main loops
  - generated by WordPress / using the `URL` the user is visiting
  - Done automatically by WordPress behind the scences.
- Secondary loops
  - created by you / using `WP_Query` class
  - Can query any/mutiple types of posts in the database
- 여러 loop를 사용하는 경우, 사용한 후 초기화 시켜줘야 한다.
- WP_Query 클래스는 여러 테마, 플러그인에서 사용하므로 주의해서 사용해야 한다.

(`WP_Query`)[https://developer.wordpress.org/reference/classes/wp_query/]

(`WP_Post`)[https://developer.wordpress.org/reference/classes/WP_Post/]

(`wp_reset_postdata()`)[https://developer.wordpress.org/reference/functions/wp_reset_postdata/]

- restores the $post global to the current post in the main query.

(`the_post()`)[https://developer.wordpress.org/reference/functions/the_post/]

- iterate the post index in the loop

WP_Query Class를 사용해야 하는 경우

- A list of related posts undert the current post / ex. all pots in the same category
- To create two loops on the same page / ex. FAQ page with the question titles at the top and the content beneath
- To create custom list of current posts in the sidebar or the footer of your site, when the Recent Posts widget doesn't do what you need
- To create custom queries for taxonomies uding more than one taxonomy to define what's displayed.

WP_Query Class를 사용하면 불편한 경우

- 특정 포스트나 카테고리에 따라 레이아웃 스타일을 다르고 하고 싶은 경우, WP_Query를 사용하는 것 보다 새로운 템플렛을 만들고 loop에서 해당 템플릿을 사용하도록 한다.
- 기본값보다 많거나 적은 post를 출력하고 싶은 경우, WP_Query 를 사용해서 새로운 query를 만들지 않고. `pre_get_posts`를 사용해서 메인 쿼리를 수정한다. 조건문을 함께 사용할 수 있다.

4 ~ 5 개 이상의 query를 사용해야하는 경우, 차라리 새로운 페이지를 만드는게 좋다.

single.php / Related Posts

```php
<?php
  $categories   = get_the_category();
  // printout data: print_r($categories);

  $rp_query     =   new WP_Query([
    // how many result
    'post_per_page'     =>    2,
    // not include current post
    'post__not_in'      =>    [$post->ID],
    // same category // categotries가 존재하는 경우 term_id, 아닌 경우 null
    'cat'               => !empty($categories) ? $categories[0]->term_id : null
  ]);
  // return array of post

  // secondary loop
  if ($rp_query->have_posts()) {
    while ($rp_query->have_posts()) {
      $rp_query->the_post();
  ?>
    // thumnail 이 존재한다면
    <?php if (has_post_thumbnail()) { ?>
       <a href="<?php get_permalink(); ?>">
          <?php the_post_thumbnail('thumnail'); ?>
        </a>
    <?php
      }
    ?>
    <?php the_permalink(); ?> // 원본 링크
    <?php echo the_title(); ?> // 제목
    <?php comments_number('0'); ?> // 댓글 수
    <?php the_excerpt(); ?> // 내용
  <?php
    }
    // reset $post global varibale
    // reset secondary loop
    wp_reset_postdata();
  }
?>
```

## Page Template (page.php)

- WordPress will load a template called `page.php` for page templates
- Pages templates tend to be a more minial version of a single post template, but it's completely up to the developer/designer.
- If you use the main loop multiple times, then you need to reset the loop every time using the `rewind_posts()` function.
- If you plan on integrating other plugins then it's always good to check if their activated. One way of checking is by using the `function_exists()` function

Page Template Order

1.  Custom Template File
2.  page-{slug}.php
3.  page-{id}.php
4.  _page.php_
5.  singular.php
6.  index.php

create loop

```php
<?php
  get_header();
  while( have_posts() ){
    the_post();
    ?>
    <!-- Page Title !-->
    <section id="page-title">
      <div class="container clearfix">
        <h1><?php the_title(); ?></h1>
        <span>
          <?php
            if( function_exists( 'the_subtitle' ){
              the_subtitle();
            }
          ?>
        </span>
      </div>
    </section>
    <?php
  }
?>
<?php rewind_posts(); ?>
```

without loop (simple solution)

```php
<?php get_header(); ?>

<!-- Page Title !-->
<section id="page-title">
  <div class="container clearfix">
    <h1><?php single_post_title(); ?></h1>
    <span>
      <?php
        if( function_exists( 'the_subtitle' )){
          the_subtitle();
        }
      ?>
    </span>
  </div>
</section>

```

`rewind_posts`: Rewind the posts in order to re-use the same query in different locations on a page

Plugin: WP Subtitle

## 404 and Category Template

- 404 / 404.php
- catetory / category.php
- search form:` <?php get_search_form(); ?>`
- a resusable templage: `<?php get_template_part(); ?>`

# 404.php

404 Template Order

1. 404.php
2. index.php

```php
<?php get_header(); ?>

// make it translatable
// page title
<h1><?php _e( 'Page Not Found', 'udemy' ); ?></h1>
// heading
<h4><?php _e( "Oooops! The Page you were looking for, couldn't be found.", 'udemy' ); ?></h4>

// search form
<?php get_search_form(); ?> // searchform.php

<?php get_footer(); ?>
```

Category Template Order

1. category-{slug}.php
2. _category-{id}.php_
3. _category.php_
4. archive.php (Tags, Dates...)
5. index.php

# category.php

```php
<?php get_header(); ?>

// Page title
<section id="page-title">
  <div class="container clearfix">
    <h1><?php the_archive_title(); ?></h1>
    <span>
      <?php the_archive_description(); ?>
    </span>
  </div>
</section>

// section

<?php get_footer(); ?>

```

id / slug 에 따른 별도의 템플릿을 적용해야 하는 경우 (taxonomy=category&tag_ID=6)

category-6.php

```php
<section id="page-title">
  <div class="container clearfix">
    <h1><?php the_archive_title(); ?> <em class="text-danger">IMPORTANT</em></h1>
    <span>
      <?php the_archive_description(); ?>
    </span>
  </div>
</section>

```

The index template should be loaded only when any other template is not suitable for the job.
(index 페이지에 의존하는 페이지가 많아 질수록, 웹사이트를 수정하기 힘들어 진다.)

## Date Template

- Date templates are not commonly created, but you may come across them so its good to know how to work with them.
- The date template is a type of archive template. It can be used for displaying posts within a certain year, month or day.
- WordPress doesn't provide much flexibility with this template. You'll need to use conditional tags to render date specific content.

Date Order Template

1. date.php
2. archive.php
3. index.php

date.php

```php
// copy from category template
// the_archive_description ->
<span>
<?php
  if( is_year() ){
    ?>You are viewing a year archive.<?php
  } else if( is_month() ){
    ?>You are viewing a month archive.<?php
  } else if( is_day() ){
    ?>You are viewing a day archive.<?php
  }
?>
</span>
```

한계: 선택된 날짜에 post가 없으면 404 템플릿이 출력된다.

## 30 Attachment Templates

- Attachments are what WordPress calls the images, videos, and any other files you uploaded on your site through the media uploader
- If you create an attachment template, then you're responsible for displaying the attachment
- The _post_ varialbe contains information about the attachments such as the full HTTP URL.
- Mine types specify what kind of file you're dealing with

# What are mime types?

- A mine type is a way for a program/browser to identify what kind of file is being loaded.
- Similar to extensions.
- Stored internally.

# Attachment Template order

1. {Mine-type}.php
2. attachment.php
3. sinle-attachment-{slug}.php
4. single.php
5. singular.php
6. index.php

# attachment.php

```php
// copy from single.php
// title / content / comment
<a href="<?php echo $post->guid; ?>">Direct Dowload</a>
<?php
  // echo "<pre";
  // print_r( $post );
  // echo "</pre";
  // $post->post_type
  // $post->post_min_type
  // $post->guid
  the_content();
?>
```

# image.php

```php
// copy from attachment.php
<img src="<?php echo $post->guid; ?>" alt="" class="img-responsive"/>
```

## Search and Custom Template

- The _search.php_ file is for search templates. It's important that you provibe a form with the searched term.
- Custom template files allow you to give users the choice to choose different template designs.
- You can name your templates whatever you want. It's best to keep the names short and concise.
- Custom templates can be applied to multiple post types. This is a new featured in versions 4.7 and above.

# search.php

```php
// page title
<section id="page-title">
  <h1><?php _e('Search Results for:', 'udemy'); ?> <?php the_search_query(); ?></h1>
</section>
// search box
<div>
  <div><?php _e('What are you searching for today?', 'udemy'); ?></div>
  <div><?php get_search_form(); ?></div>
</div>
```

# full-width-page.php

post type: page

```php
<?php
/*
* Template Name: Full Width Page
*/
?>

// copy from page.php
// remove sidebar
```

Creating page templates for specific post types

- 기본적으로 페이지에서만 커스텀 템플릿을 사용할 수 있다.
- 템플릿의 블록 주석에 타입을 설정하면, 다른 포스트 타입도 커스텀 템플릿을 선택 할 수 있다.
- WP 4.7+

```php
<?php
/*
* Template Name: Full Width Page
* Template Post Type: post, page, event
*/
?>
```

# full-width-post.php

```php
// copy from single.php
<?php
/*
* Template Name: Full Width Post
* Template Post Type: post
*/
get_header();
?>
```

## Completing the Header, Title and Ad sections

- WordPress will generate the `<title>` tags for each page.
  - add_theme_support()
  - (X) wp_title(): deprecated
- WordPress will also handle proessing the logo image upload. You need to add support for it using the `add_theme_support()` function
- WP Quad is a plugin that will manage and display ads for you. Bundling plugins with your theme can increase the value and flexibility of your theme.

# header.php

```php
// delete title tag
// <title>Index Template</title>

// custom logo or default logo
<div id="logo">
  <?php
    if( has_custom_logo() ){
      the_custom_logo();
    }else{
      ?>
        <a href="<?php echo home_url( '/'); ?>" class="standard-logo">
          <?php bloginfo( 'name' ); ?>
        </a>
      <?php
    }
  ?>
</div>

// secondary navigation
<div class="top-links">
  <?php
    if( has_nav_men( 'secondary' )){
      wp_nav_menu([
        'theme_location'  => 'secondary',
        'container'       => false,
        'fallback_cb'     => false,
        'depth'           => 4
      ])
    }
  ?>
</div>
```

# setup.php

```php
<?php
  function ju_setup_theme(){
    add_theme_support( 'post-thumbnails' );
    add_theme_spport( 'title-tag' );
    add_theme_spport( 'custom-logo' );

    register_nav_menu( 'primary', __( 'Primary Menu', 'udemy' ));
    register_nav_menu( 'secondary', __( 'Secondary Menu', 'udemy' ));
  }
?>
```

## AD / WPQUADS

/wp-content/plugins/quick-adsense-reloaded/includes/api.php

1. 테마가 로드 되었을 때, 플러그인에서 제공하는 함수를 이용해서, 개발자가 추가하고자 하는 위치 이름과 설명 지정하기

```php
function ju_setup_theme(){
  if( function_exists('quads_register_ad')){
    quads_register_ad( array(
        'location'      => 'udemy_header',
        'description'   => 'Udemy Header Description'));
    //
  }
}
```

2. 플러그인 대시 보드에서 광고 컨텐츠와 사용자가 지정한 위치에 연결 하기

3. 지정된 광고 컨텐츠를 해더에 입력하기

```php
<div class="top-advert">
  <?php
    if( function_exists('quads_ad'){
      echo quads_ad([ 'location' => 'udemy_header ']);
    })
  ?>
</div>
```

## Theme Customizer API

- The WordPress customizer allows users to modify a theme while also previewing those changes in real time.
- The customizer is growing in popularity. A lot of developers are opting to use it because it's very easy to extend.
- There are 3 steps you'll go through when working with the customizer.
  1. Creating a setting database value
  2. Creating a section that will contain all the controllers
  3. creating a controller that is assigned under a section and updates a setting
- To use a setting on your theme you need to call the function `get_theme_mod()` with the name of the setting passed in as the first parameter. The setting will be returned so you will need to echo it out if you need to display it.

### functions.php

```php
<?php

// includes
include( get_theme_file_path('includes/theme-customeizer.php') );
include( get_theme_file_path('includes/customizer/social.php') );


// hooks
add_action( 'customize_register', 'ju_customize_register');
?>
```

### includes/theme-customizer.php

```php
<?php

function ju_customize_register( $wp_customize ){
  ju_social_customizer_section( $wp_customize );
}

?>
```

# includes/customeizer/social.php

```php
<?php
  function ju_social_customizer_section( $wp_customize ){
    // setting: create the database value
    $wp_customize->add_setting( 'ju_facebook_handle', [
      'default'   => ''
    ]);

    // section
    $wp_customize->add_section( 'ju_social_section', [
      'title'   =>    __('Udemy Social Seittings', 'udemy'),
      'priority' => 30
    ]);

    // controllers: create the input field
    $wp_customize->add_control( new WP_Customize_Control(
      $wp_customize,
      'ju_social_facebook_input',
      array(
        'label'       => __('Facebook Handle', 'udemy'),
        'section'     => 'ju_social_section',
        'settings'    => 'ju_facebook_handle'
        'type'        => 'text'
      )
    ));
  }
?>
```

# WP Customizer Concepts

1. Setting - A value that is saved in the database
2. Section - A way to group input fields together
3. Controller - An input field that is usually placed inside a section and modifies one setting

# header.php

```php
<div id="top-social">
  <?php
    if( get_theme_mod( 'ju_facebook_handle' )){
      ?>
        <li>
          <a href="https://facebook.com/<?php echo get_theme_mod('ju_facebook_handle'); ?">facebook</a>
        </li>
      <?php
    }
  ?>
</div>
```

## Dropdown and Checkboxes using the Customizer API

- You can create checkbox fields by setting the type key to checkbox
- The choices key is used to set the values for checkbox. The key will be the value of the checkbox itself. The value will be the human readable text.
- The dropdown-pages will create a dropdown of all published pages on your WordPress site.
- You can set value to 0 to tell WordPress you don't want to select a page.

# header.php

```php
// copy from searchform
// action & translatable text
 <form action="<?php echo esc_url( home_url( '/' ); ?>" method="get">
  <input
    type="text"
    name="s"
    class="form-control"
    placeholder="<?php _e('Type &amp; Hit Enter...', 'udemy'); ?>"
    value="<?php the_search_query(); ?>"
  >
 </form>
```

# includes/customizer/misc.php

```php
function ju_misc_customizer_section( $wp_customize ){;
  $wp_customize->add_setting( 'ju_header_show_search', array(
      'default'     =>      'yes'
  ))

  $wp_customize->add_setting( 'ju_header_show_cart', array(
      'default'     =>      'yes'
  ))

  $wp_customize->add_setting( 'ju_footer_copyright_text', array(
      'default'     =>      'Copyrights &copy; 2019 All Rights Reserved. '
  ))

  $wp_customize->add_setting( 'ju_footer_tos_page', array(
      'default'     =>      0
  ))

  $wp_customize->add_setting( 'ju_footer_privacy_page', array(
      'default'     =>      0
  ))

  $wp_customize->add_section( 'ju_misc_scriont', [
    'title'     =>  __( 'Udemy Misc Settings', 'udemy'),
    'priority'  =>  30
  ])

  $wp_customize->add_control(new WP_Customize_Control(
    $wp_customize,
    'ju_header_show_search_input',
    array(
      'label'     =>  __('Show Search Button in Header', 'udemy'),
      'section'   =>  'ju_misc_section',
      'settings'  =>  'ju_header_show_search',
      'type'      => 'checkbox',
      'choices'   =>  [
        'yes'     => 'Yes'
      ]
    )
  ))

  $wp_customize->add_control(new WP_Customize_Control(
    $wp_customize,
    'ju_header_show_search_input',
    array(
      'label'     =>  __('Show Cart in Header', 'udemy'),
      'section'   =>  'ju_misc_section',
      'settings'  =>  'ju_header_show_cart',
      'type'      => 'checkbox',
      'choices'   =>  [
        'yes'     => 'Yes'
      ]
    )
  ))

  $wp_customize->add_control(new WP_Customize_Control(
    $wp_customize,
    'ju_footer_copyright_text',
    array(
      'label'     =>  __('Show Copyright Text in footer', 'udemy'),
      'section'   =>  'ju_misc_section',
      'settings'  =>  'ju_footer_copyright',
    )
  ))

  $wp_customize->add_control(new WP_Customize_Control(
    $wp_customize,
    'ju_footer_tos_page',
    array(
      'label'     =>  __('Footer TOS Page', 'udemy'),
      'section'   =>  'ju_misc_section',
      'settings'  =>  'ju_footer_tos_page',
      'type'      => 'dropdown-pages',
    )
  ))

  $wp_customize->add_control(new WP_Customize_Control(
    $wp_customize,
    'ju_footer_provacy_page_input',
    array(
      'label'     =>  __('Footer Privacy Policy Page', 'udemy'),
      'section'   =>  'ju_misc_section',
      'settings'  =>  'ju_footer_privacy_page',
      'type'      => 'dropdown-pages',
    )
  ))
}
```

# functions.php

```php
include( get_theme_file_path( '/includes/customizer/misc.php' ) );
```

# theme-cusomizer.php

```php
function ju_customize_register( $wp_customize ){
  ju_misc_customizer_section( $wp_customize );
}
```

# header.php

```php
<?php
  if( get_theme_mod( 'ju_header_show_cart' ) ){
    ?>
    <div id="top-cart"></div>
    <?php
  }
?>

<?php
  if( get_theme_mod( 'ju_header_show_search' ) ){
    ?>
    <div id="top-search"></div>
    <?php
  }
?>
```

# footer.php

```php
<?php echo get_theme_mod( 'ju_footer_copyright_text' ); ?>
<?php
  if(get_theme_mod('ju_footer_tos_page')){
    ?>
      <a href="<?php the_permalink(get_theme_mod('ju_footer_tos_page')); ?>">Terms of Use</a>
    <?php
  }
?>
<?php
  if(get_theme_mod('ju_footer_privacy_page')){
    ?>
      <a href="<?php the_permalink(get_theme_mod('ju_footer_privacy_page')); ?>">Privacy Policy</a>
    <?php
  }
?>
```

## 35 Customizer Transports and Overriding existing Settings

- The order WordPress organizes the customizer is **Panels > Sections > Controller**
- You are allowed to modify the current existing customizer by simply grabbing what you want to modify with the appropriate **get** method and then changing the properties.
- You can `var_dump()` the **wp_customize** object. It's great way to learn and understand what's being used inside the customizer.
- Setting the **transpor** to **postMessage** Wordpress will let you handle how content is reflected in the preview though JavaScript.

# Hierachy

1. Panels
2. Sections
3. Controllers

# theme-customizer.php

```php
<?php function ju_customize_register( $wp_customize ){

  $wp_customize->add_panel('udemy', [
    'title'         => __('Udemy', 'udemy'),
    'description'   => '<p>Udemy Theme Settings</p>',
    'priority'      => 160
  ]);

  ju_social_customizer_section( $wp_customize );
  ju_misc_customizer_section( $wp_customize );
}
?>
```

# misc.php

```php
$wp_customize->add_section( 'ju_misc_sction', [
  'title'     => __( 'Udemy Misc Settings', 'udemy'),
  'priority'  => 30,
  'pannel'    => 'udemy'
])

$wp_customize->add_section( 'ju_social_sction', [
  'title'     => __( 'Udemy Social Settings', 'udemy'),
  'priority'  => 30,
  'pannel'    => 'udemy'
])
```

# theme-customizer.php // 패널 이름 바꾸기

```php
<?php function ju_customize_register( $wp_customize ){
  // echo '<pre>';
  // var_dump( $wp_customize );
  // echo '</pre>';

  $wp_customize->get_section( 'title_tagline' )->title = 'General';
}
```

```
Controllers - get_control()
Panels - get_panel()
Settings - get_setting()
```

# Setting to not refresh page

misc.php

```php
<?php
$wp_cutomize->add_setting( 'ju_header_show_search', [
  'default'   =>  'yes',
  'transport' => 'postMessage'
])

$wp_cutomize->add_setting( 'ju_header_show_cart', [
  'default'   =>  'yes',
  'transport' => 'postMessage'
])
?>
```

trnasport

- default: refresh / 값이 변경 되면 페이지를 새로고침한다.
- postMessage: 값의 변경에 상관없이 개발자가 자바스크립트를 통해 페이지를 새로 고침한다.

/assets/js/theme-cutomize.js

```js
// jQuery Initializer
(function ($) {
  wp.customize("ju_header_show_search", function (value) {
    value.bind(function (new_val) {
      if (new_val) {
        $("#top-search").show();
      } else {
        $("#top-search").hide();
      }
    });
  });

  wp.customize("ju_header_show_cart", function (value) {
    value.bind(function (new_val) {
      if (new_val) {
        $("#top-cart").show();
      } else {
        $("#top-cart").hide();
      }
    });
  });
})(jQuery);
```

functions.php

```php
include( get_theme_file_path( '/includes/customizer/enqueue.php' ));
add_action( 'cutomize_preview_init', 'ju_cutomize_preview_init' );

```

includes/customizer/enqueue.php

```php
<?php
  function ju_cutomize_preview_init(){
    wp_enqueue_script(
      'ju_theme_customizer',
      get_theme_file_uri( '/assets/js/theme-customize.js' ),
      ['Jquery', 'cutomize-preview'],
      false,
      true
    )
  }
?>

```

## 36 Color & Upload Controllers for the Customizer

- The color control can be used to render a color picker in the WordPress customizer.
- Use the `wp_add_inline_style()` function to load CSS directly inside the HTML document. This is great for loading dynamic CSS
- Alternatively, you can create a PHP file that will load dynamic CSS and change the headers.
- The upload control will return the full HTTP URL to the file the user selected or uploaded.

# Change Color

misc.php

```php
$wp_cutomize->add_setting( 'ju_read_more_color', [
  'default'   => '#1ABC9C';
])

$wp_cutomize->add_setting( 'ju_report_file', [
  'default'   => '';
])

$wp_customize->add_control(
  new WP_Customize_Color_Control(
    $wp_customize,
    'ju_read_more_color_input', array(
      'label'      => __('Read more link color', 'udemy'),
      'section'    => 'ju_misc_section',
      'settings'   => 'ju_read_more_color'
    )
  )
)

$wp_customize->add_control(
  new WP_Customize_Upload_Control(
    $wp_customize,
    'ju_report_file_input', array(
      'label'      => __('File Report', 'udemy'),
      'section'    => 'ju_misc_section',
      'settings'   => 'ju_report_file'
    )
  )
);

```

enqueue.php

```php
wp_add_inline_style(
  'just_cutom',
  'a.more-link{ color: ' . $read_more_color . '; border-color:' . $read_more_color . '; }'
);

```

footer.php

```
<?php
  if( get_theme_mod( 'ju_report_file' ) ){
    ?>
      <a href="<?php echo get_theme_mod('ju_report_file'); ?>">Download Report</a>
    <?php
  }
?>
```

## 37 More Theme Support & Creating Starter Content

- RSS feeds are a way for users to grab the lastest content from your site without having to read it.
- If you plan on taking advantage of HTML5 features, then you'll need to add support for it and pass in what tags you'd like to add support for.
- The starter content feature allows you to create dummy content for the cutomizer for users who are installing your theme on a fresh installation of WordPress.
- To stimulate a fresh site, you can change the `fresh_site` value to `1`. You can find this option inside the `wp_options` table.

# `add_theme_support()`

setup.php

- Supporting RSS is completely optional. The impact on your site is very minimal.
- By default, Wordpress will make all it's HTML generated tpo be XHTML compatible. If you want to take advantage of HTML5 features, then you'll need to let WordPress know.
- The 'widgets' key determines what dummy widgets will be loaded.
- Attachments is a special post type. All files and images you upload are considered attachments.
- **show_on_front** is an option for determining whether the home page will be a list of posts or a single page.

```php
function ju_setup_theme(){
  add_theme_support( 'automatic-feed-links' );
  add_theme_support( 'html5', array('comment-list', 'comment-form', 'search-form', 'gallery', 'caption') );
  add_theme_support( 'start-content', [
    'widgets'            => [
      'ju_sidebar'       => [
        'text_business_info', 'search', 'text_about'
      ]
    ],

    'attachments'        => [
      'image-about'      => [
        'post_title'    => __('About', 'udemy'),
        'file'          => 'assets/images/about/1.jpg' // relative to template directory
      ]
    ],

    'posts'              => [
      'home'             => array(
        'thumbnail'      => '{{image-about}}'
      ),
      'about'             => array(
        'thumbnail'      => '{{image-about}}'
      ),
      'contact'             => array(
        'thumbnail'      => '{{image-about}}'
      ),
      'blog'             => array(
        'thumbnail'      => '{{image-about}}'
      ),
      'homepage-section' => array(
        'thumbnail'      => '{{image-about}}'
      ),
    ],

    'options'            => [
      'show_on_front'       => [
        'show_on_front'  => 'page',
        'page_on_front'  => '{{home}}',
        'page_for_posts' =>  '{{blog}}'
      ]
    ],

    'theme_mods'         => [
      'ju_facebook_handle'    => 'udemy',
      'ju_twitter_handle'     => 'udemy',
      'ju_instagram_handle'   => 'udemy',
      'ju_email'              => 'udemy',
      'ju_phone_number'       => 'udemy',
      'ju_header_show_search' => 'yest',
      'ju_header_show_cart'   => 'yest',
    ],

    'nav_menus'          => [
      'primary'       => array(
        'name'        => __('Primary Menu', 'udemy'),
        'items'       => array(
          'link_home',
          'page_about',
          'page_blog',
          'page_contact'
        )
      ),

      'secondary'    => array(
        'name'        => __('Secondary Menu', 'udemy'),
        'items'       => array(
          'link_home',
          'page_about',
          'page_blog',
          'page_contact'
        )
    ],
  ])
}
```

워드프레스 사이트가 설치 직후 모습으로 보여지도록 설정 (커스터마이징 대시보드에만 적용)

`wp_options table / fresh_site / 1`

## 38 Displaying Popular Posts and Conditional Tags

- Conditional tags are a way to check what kind of page is being displayed.
- Wordpress popular posts is a plugin that keeps track of how many views a post is and will help display the most popular posts.

# [Plugin] WordPress Popular Posts by Hector Cobrera

parameters / template tag

index.php

```php
<?php
if( !is_single && is_home() && function_exists( 'wpp_get_mostpopular' ) && get_theme_mod('ju_show_header_popular_posts')){
    wpp_get_mostpopular([
      'wpp_start' => '<div class="section header-stick"><div><span>' . get_theme_mod('ju_popular_posts_widget_title') . '<span>...',
      'wpp_end'   => '...</div></div>',
      'post_html' => '<div class="slide"><a href="{url}">{text-title}</a></div>'
    ])
  ?>
  <?php
}
?>
```

misc.php

```php
$wp_customize->add_setting( 'ju_show_header_popular_posts', [
  'default'   => false
]);

$wp_customize->add_setting( 'ju_popular_posts_widget_title', [
  'default'   => 'Breaking News'
]);

$wp_customize->add_control(
  new WP_Customize_Upload_Control(
    $wp_customize,
    'ju_show_header_popular_posts_widget_input',
    array(
      'label'     =>  __( 'Show Header Popular Posts Widget', 'udemy'),
      'section'   => 'ju_misc_section',
      'settings'  => 'ju_popular_posts_widget_title',
      'type'      => 'checkbox',
      'choices'   => [
        'yes'     => __('Yes', 'udemy')
      ]
    )
  )
);

$wp_customize->add_control(
  new WP_Customize_Upload_Control(
    $wp_customize,
    'ju_show_header_popular_posts_title_input',
    array(
      'label'     =>  __( 'Popular Posts Widget Title', 'udemy'),
      'section'   => 'ju_misc_section',
      'settings'  => 'ju_popular_posts_widget_title',
    )
  )
);
```

## Finishing Touches

- The **dir** attribute determines the diresction text is displayed. Left-to-right is the default for most browsers.
- The **lang** attribute will determine the language used for the site
- The **meta charset** determines the character set that should be used for displaying the content of the site.
- The **post_class()** function will output classes for the current post. It's also a good idea to give each post a unique ID.

header.php

```php
<html <?php language_attributes(); ?>>
<head>
  <meta http-equiv="content-type" content="text/html; charset=<?php blogInfo('charset') ?>" />
```

single.php

```php
<div id="post-<?php the_ID(); ?>" <?php post_class(single-post nobottommargin); ?>>...</div>

```

# 04 Theme Template
